# NSP-Overcoming-Noise
A project aimed to overcome thermal noise generated by the heat of near sensor processing using a neural network trained on images with dark-current-induced noise.
This project is being carried out as an independent study which has started in the spring of 2022. 


## First : Capture
Images will be captured using a FLIR BlackFly 3 Camera which has noise induced using a heat-gun. The safety of heating the camera will be ensured using python code which relies on the Spinnaker SDK from FLIR.

This script is called HeatSafety.py, it is essentially a camera trigger that triggers based on heat. 
#### Depends on:

>PySpin https://www.flir.com/products/spinnaker-sdk/
```
import PySpin
import sys
import time
```

#### Runs as: 
> Run as Python3 HeatTrigger.py

Main Additions to FLIR SDK Trigger.py are:

```
def GetCameraTemperature(cam):
    x = 0
    if cam.DeviceTemperature.GetAccessMode() == PySpin.RO:
        x = cam.DeviceTemperature.ToString()
    x = float(x)
    return x
```
as well as:
```
def Go(cam, GoalTemperature):
    # Get Temperature of Camera

    Temp = GetCameraTemperature(cam)
    print(GoalTemperature)

    # Heating
    while Temp < GoalTemperature:
        cam.Init()
        Temp = GetCameraTemperature(cam)
        print(Temp)
        time.sleep(3)  # Protects the camera.

    # Capture 10 images
    if Temp > GoalTemperature:
        # cam.DeInit()
        print("Capturing, please continue heating")
        Capture(cam)  # Cites : FLIR TELEDYNE
```

The heat testing is done using a loop in the ``` main()``` method. 

```
# Bootstrap
def main():
    system = PySpin.System.GetInstance()

    # Retrieve list of cameras from the system
    cam_list = system.GetCameras()

    num_cameras = cam_list.GetSize()

    # From Spinnaker SDK Examples
    if num_cameras == 0:
        # Clear camera list before releasing system
        cam_list.Clear()

        # Release system instance
        system.ReleaseInstance()
        print("\n")
        print('Camera(s) not detected, please check your connection and try again.')
        print("\n")
        return False

    # List of Cameras
    for i, cam in enumerate(cam_list):
        # List of Temperatures
        for t in range(30, 80, 5):
            # Initiates Capture
            Go(cam, t)
            time.sleep(2)

    print("Capture Complete, please cool the camera.")
    del cam

    # Clear camera list before releasing system, this makes a mess if not cleared
    cam_list.Clear()

    # Release system instance
    system.ReleaseInstance()c
```

## Next : Neural Networks
Next an object detection neural network will be implemented in Python using TensorFlow and trained on the RAW images from the camera. 



